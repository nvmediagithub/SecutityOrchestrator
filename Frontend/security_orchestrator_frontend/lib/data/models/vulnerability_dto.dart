import 'package:json_annotation/json_annotation.dart';

part 'vulnerability_dto.g.dart';

@JsonSerializable()
class VulnerabilityDto {
  final String id;
  final String title;
  final String description;
  final String severity; // LOW, MEDIUM, HIGH, CRITICAL
  final String category; // OWASP category
  final double cvssScore;
  final String cvssVector;
  final String recommendation;
  final String endpoint;
  final String parameter;
  final Map<String, dynamic> evidence;
  final List<String> references;
  final DateTime discoveredAt;
  final String status; // OPEN, RESOLVED, FALSE_POSITIVE

  VulnerabilityDto({
    required this.id,
    required this.title,
    required this.description,
    required this.severity,
    required this.category,
    required this.cvssScore,
    required this.cvssVector,
    required this.recommendation,
    required this.endpoint,
    required this.parameter,
    required this.evidence,
    required this.references,
    required this.discoveredAt,
    required this.status,
  });

  factory VulnerabilityDto.fromJson(Map<String, dynamic> json) =>
      _$VulnerabilityDtoFromJson(json);

  Map<String, dynamic> toJson() => _$VulnerabilityDtoToJson(this);
}

@JsonSerializable()
class VulnerabilitySummaryDto {
  final String id;
  final String title;
  final String severity;
  final String category;
  final double cvssScore;
  final String endpoint;
  final DateTime discoveredAt;

  VulnerabilitySummaryDto({
    required this.id,
    required this.title,
    required this.severity,
    required this.category,
    required this.cvssScore,
    required this.endpoint,
    required this.discoveredAt,
  });

  factory VulnerabilitySummaryDto.fromJson(Map<String, dynamic> json) =>
      _$VulnerabilitySummaryDtoFromJson(json);

  Map<String, dynamic> toJson() => _$VulnerabilitySummaryDtoToJson(this);
}

enum Severity {
  @JsonValue('LOW')
  low,
  @JsonValue('MEDIUM')
  medium,
  @JsonValue('HIGH')
  high,
  @JsonValue('CRITICAL')
  critical,
}

enum VulnerabilityStatus {
  @JsonValue('OPEN')
  open,
  @JsonValue('RESOLVED')
  resolved,
  @JsonValue('FALSE_POSITIVE')
  falsePositive,
}